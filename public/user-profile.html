<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mon Compte - SPORTWEAR</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@600;700;800;900&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #FF6B35;
            --primary-dark: #e55a2b;
            --primary-light: #ff8f66;
            --primary-glow: rgba(255, 107, 53, 0.3);
            --accent: #6366f1;
            --dark: #0f172a;
            --dark-800: #1e293b;
            --gray: #64748b;
            --gray-light: #94a3b8;
            --light: #f8fafc;
            --lighter: #f1f5f9;
            --border: #e2e8f0;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --radius: 20px;
            --radius-lg: 28px;
            --shadow-sm: 0 4px 6px -1px rgba(0,0,0,0.05);
            --shadow-md: 0 10px 25px rgba(0,0,0,0.08);
            --shadow-lg: 0 25px 50px rgba(0,0,0,0.12);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        html { scroll-behavior: smooth; }
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: var(--lighter); }
        ::-webkit-scrollbar-thumb { background: var(--primary); border-radius: 10px; }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            color: var(--dark);
            min-height: 100vh;
        }

        .top-bar {
            background: linear-gradient(90deg, var(--dark) 0%, var(--dark-800) 100%);
            color: white;
            text-align: center;
            padding: 12px;
            font-size: 0.8rem;
            font-weight: 600;
            letter-spacing: 1px;
        }
        .top-bar span { color: var(--primary); }

        .header {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(0,0,0,0.05);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .nav-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo-text {
            font-family: 'Montserrat', sans-serif;
            font-size: 1.8rem;
            font-weight: 900;
            color: var(--dark);
            font-style: italic;
            text-decoration: none;
        }
        .logo-text span { color: var(--primary); }

        .nav-links {
            display: flex;
            gap: 2.5rem;
            align-items: center;
        }

        .nav-links a {
            color: var(--dark);
            text-decoration: none;
            font-weight: 600;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            transition: color 0.3s;
        }
        .nav-links a:hover { color: var(--primary); }

        .header-actions {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .icon-btn {
            width: 48px;
            height: 48px;
            border-radius: 14px;
            border: 2px solid var(--border);
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
            text-decoration: none;
        }
        .icon-btn:hover {
            background: var(--primary);
            border-color: var(--primary);
        }
        .icon-btn:hover svg { stroke: white; }
        .icon-btn svg {
            width: 22px;
            height: 22px;
            stroke: var(--dark);
            stroke-width: 2;
            fill: none;
            transition: stroke 0.3s;
        }

        .profile-hero {
            background: linear-gradient(135deg, var(--dark) 0%, var(--dark-800) 100%);
            padding: 4rem 2rem;
            position: relative;
            overflow: hidden;
        }
        .profile-hero::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -10%;
            width: 500px;
            height: 500px;
            background: radial-gradient(circle, var(--primary-glow) 0%, transparent 70%);
            pointer-events: none;
        }

        .hero-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            gap: 2rem;
            position: relative;
            z-index: 1;
        }

        .hero-avatar {
            width: 120px;
            height: 120px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            border-radius: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-family: 'Montserrat', sans-serif;
            font-size: 3.5rem;
            font-weight: 900;
            box-shadow: 0 20px 50px rgba(255, 107, 53, 0.4);
            flex-shrink: 0;
        }

        .hero-info h1 {
            font-family: 'Montserrat', sans-serif;
            font-size: 2.5rem;
            font-weight: 900;
            color: white;
            margin-bottom: 0.5rem;
        }
        .hero-info p {
            color: var(--gray-light);
            font-size: 1.1rem;
        }
        .hero-info .member-badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            background: rgba(255,255,255,0.1);
            padding: 8px 16px;
            border-radius: 50px;
            margin-top: 1rem;
            color: var(--primary-light);
            font-weight: 600;
            font-size: 0.85rem;
        }

        .profile-container {
            max-width: 1200px;
            margin: -3rem auto 3rem;
            padding: 0 2rem;
            display: grid;
            grid-template-columns: 280px 1fr;
            gap: 2rem;
            position: relative;
            z-index: 2;
        }

        .profile-sidebar {
            background: white;
            border-radius: var(--radius-lg);
            padding: 1.5rem;
            height: fit-content;
            position: sticky;
            top: 100px;
            box-shadow: var(--shadow-md);
            border: 1px solid rgba(0,0,0,0.04);
        }

        .sidebar-nav {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .sidebar-nav-item {
            display: flex;
            align-items: center;
            gap: 14px;
            padding: 16px 20px;
            border-radius: 16px;
            color: var(--gray);
            text-decoration: none;
            font-weight: 600;
            font-size: 0.95rem;
            transition: all 0.3s;
            cursor: pointer;
            border: none;
            background: none;
            width: 100%;
            text-align: left;
        }
        .sidebar-nav-item:hover {
            background: var(--lighter);
            color: var(--dark);
            transform: translateX(4px);
        }
        .sidebar-nav-item.active {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            box-shadow: 0 10px 30px rgba(255, 107, 53, 0.3);
        }
        .sidebar-nav-item svg {
            width: 22px;
            height: 22px;
            stroke: currentColor;
            stroke-width: 2;
            fill: none;
        }

        .sidebar-divider {
            height: 1px;
            background: var(--border);
            margin: 1rem 0;
        }

        .logout-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            width: 100%;
            padding: 16px;
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.1) 0%, rgba(239, 68, 68, 0.05) 100%);
            border: 2px solid transparent;
            border-radius: 16px;
            color: var(--danger);
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Inter', sans-serif;
            font-size: 0.95rem;
        }
        .logout-btn:hover {
            background: var(--danger);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(239, 68, 68, 0.3);
        }
        .logout-btn svg {
            width: 20px;
            height: 20px;
            stroke: currentColor;
            stroke-width: 2;
            fill: none;
        }

        .profile-main { min-height: 500px; }

        .tab-content {
            display: none;
            animation: fadeInUp 0.4s ease;
        }
        .tab-content.active { display: block; }
        
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(15px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .card {
            background: white;
            border-radius: var(--radius-lg);
            padding: 2rem;
            margin-bottom: 1.5rem;
            box-shadow: var(--shadow-sm);
            border: 1px solid rgba(0,0,0,0.04);
            transition: all 0.3s;
        }
        .card:hover { box-shadow: var(--shadow-md); }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid var(--lighter);
        }

        .card-title {
            font-family: 'Montserrat', sans-serif;
            font-size: 1.4rem;
            font-weight: 800;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .card-title::before {
            content: '';
            width: 5px;
            height: 24px;
            background: linear-gradient(180deg, var(--primary) 0%, var(--primary-dark) 100%);
            border-radius: 5px;
        }

        .card-action {
            color: var(--primary);
            text-decoration: none;
            font-weight: 700;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: gap 0.3s;
        }
        .card-action:hover { gap: 10px; }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1.5rem;
        }

        .stat-card {
            background: linear-gradient(135deg, var(--lighter) 0%, white 100%);
            border-radius: var(--radius);
            padding: 2rem;
            text-align: center;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid var(--border);
            position: relative;
            overflow: hidden;
        }
        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary) 0%, var(--accent) 100%);
            opacity: 0;
            transition: opacity 0.3s;
        }
        .stat-card:hover::before { opacity: 1; }
        .stat-card:hover {
            transform: translateY(-8px);
            box-shadow: var(--shadow-lg);
            border-color: transparent;
        }

        .stat-icon {
            width: 64px;
            height: 64px;
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1.25rem;
        }
        .stat-icon svg {
            width: 28px;
            height: 28px;
            stroke: white;
            stroke-width: 2;
            fill: none;
        }
        .stat-icon.orders { background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%); box-shadow: 0 10px 30px rgba(59, 130, 246, 0.3); }
        .stat-icon.wishlist { background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%); box-shadow: 0 10px 30px rgba(255, 107, 53, 0.3); }
        .stat-icon.reviews { background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); box-shadow: 0 10px 30px rgba(245, 158, 11, 0.3); }

        .stat-value {
            font-family: 'Montserrat', sans-serif;
            font-size: 2.75rem;
            font-weight: 900;
            color: var(--dark);
            margin-bottom: 0.25rem;
        }

        .stat-label {
            color: var(--gray);
            font-size: 0.9rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
        }

        .form-group { margin-bottom: 0; }
        .form-group.full { grid-column: span 2; }

        .form-group label {
            display: block;
            margin-bottom: 0.75rem;
            font-weight: 700;
            color: var(--dark);
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 16px 20px;
            border: 2px solid var(--border);
            border-radius: 14px;
            font-size: 1rem;
            font-family: 'Inter', sans-serif;
            transition: all 0.3s;
            outline: none;
            background: var(--lighter);
        }
        .form-group input:focus,
        .form-group select:focus {
            border-color: var(--primary);
            background: white;
            box-shadow: 0 0 0 4px var(--primary-glow);
        }
        .form-group input[readonly] {
            background: var(--lighter);
            color: var(--gray);
            cursor: not-allowed;
        }

        .save-btn {
            padding: 16px 40px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            border: none;
            border-radius: 14px;
            font-weight: 800;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 10px 30px rgba(255, 107, 53, 0.3);
            margin-top: 1.5rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .save-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(255, 107, 53, 0.4);
        }

        .order-card {
            background: var(--lighter);
            border-radius: var(--radius);
            padding: 1.5rem;
            margin-bottom: 1rem;
            display: grid;
            grid-template-columns: 1fr auto auto;
            align-items: center;
            gap: 2rem;
            transition: all 0.3s;
            border: 1px solid transparent;
        }
        .order-card:hover {
            background: white;
            border-color: var(--border);
            box-shadow: var(--shadow-sm);
            transform: translateX(8px);
        }

        .order-info h4 {
            font-weight: 800;
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
            font-family: 'Montserrat', sans-serif;
        }
        .order-info p {
            color: var(--gray);
            font-size: 0.9rem;
        }

        .order-status {
            padding: 10px 20px;
            border-radius: 50px;
            font-size: 0.85rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .order-status.pending { background: rgba(245, 158, 11, 0.15); color: var(--warning); }
        .order-status.delivered { background: rgba(16, 185, 129, 0.15); color: var(--success); }
        .order-status.processing { background: rgba(59, 130, 246, 0.15); color: #3b82f6; }
        .order-status.shipped { background: rgba(99, 102, 241, 0.15); color: var(--accent); }

        .order-amount {
            font-family: 'Montserrat', sans-serif;
            font-size: 1.4rem;
            font-weight: 900;
            color: var(--primary);
        }

        .wishlist-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            gap: 1.5rem;
        }

        .wishlist-item {
            background: var(--lighter);
            border-radius: var(--radius);
            overflow: hidden;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid transparent;
        }
        .wishlist-item:hover {
            transform: translateY(-8px);
            box-shadow: var(--shadow-lg);
            border-color: var(--primary-glow);
        }

        .wishlist-item img {
            width: 100%;
            height: 180px;
            object-fit: cover;
            transition: transform 0.4s;
        }
        .wishlist-item:hover img { transform: scale(1.05); }

        .wishlist-item-info {
            padding: 1.25rem;
            background: white;
        }
        .wishlist-item h4 {
            font-weight: 700;
            font-size: 1rem;
            margin-bottom: 0.5rem;
            color: var(--dark);
        }
        .wishlist-item .price {
            color: var(--primary);
            font-weight: 800;
            font-size: 1.1rem;
            font-family: 'Montserrat', sans-serif;
        }

        .wishlist-actions {
            display: flex;
            gap: 8px;
            margin-top: 1rem;
        }

        .wishlist-btn {
            flex: 1;
            padding: 12px;
            border-radius: 12px;
            font-size: 0.85rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            border: none;
            font-family: 'Inter', sans-serif;
        }
        .wishlist-btn.add-cart {
            background: var(--dark);
            color: white;
        }
        .wishlist-btn.add-cart:hover {
            background: var(--primary);
            transform: scale(1.02);
        }
        .wishlist-btn.remove {
            background: transparent;
            border: 2px solid var(--border);
            color: var(--gray);
        }
        .wishlist-btn.remove:hover {
            background: var(--danger);
            color: white;
            border-color: var(--danger);
        }

        .empty-state {
            text-align: center;
            padding: 4rem 2rem;
        }
        .empty-state svg {
            width: 100px;
            height: 100px;
            stroke: var(--gray-light);
            stroke-width: 1.5;
            fill: none;
            margin-bottom: 2rem;
            opacity: 0.4;
        }
        .empty-state h3 {
            font-family: 'Montserrat', sans-serif;
            font-size: 1.5rem;
            font-weight: 800;
            margin-bottom: 0.75rem;
        }
        .empty-state p {
            color: var(--gray);
            margin-bottom: 2rem;
            font-size: 1.1rem;
        }
        .empty-state a {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            padding: 14px 28px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            text-decoration: none;
            border-radius: 14px;
            font-weight: 700;
            transition: all 0.3s;
            box-shadow: 0 10px 30px rgba(255, 107, 53, 0.3);
        }
        .empty-state a:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(255, 107, 53, 0.4);
        }

        .notification {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            padding: 1.25rem 2rem;
            background: var(--dark);
            color: white;
            border-radius: 16px;
            font-weight: 600;
            display: none;
            z-index: 1000;
            box-shadow: 0 20px 50px rgba(0,0,0,0.25);
        }
        .notification.show { display: flex; align-items: center; gap: 12px; }
        .notification.success { background: linear-gradient(135deg, var(--success) 0%, #059669 100%); }
        .notification.error { background: linear-gradient(135deg, var(--danger) 0%, #dc2626 100%); }

        @media (max-width: 900px) {
            .profile-container { grid-template-columns: 1fr; }
            .profile-sidebar { position: relative; top: 0; }
            .form-grid { grid-template-columns: 1fr; }
            .form-group.full { grid-column: span 1; }
            .stats-grid { grid-template-columns: 1fr; }
            .hero-content { flex-direction: column; text-align: center; }
            .order-card { grid-template-columns: 1fr; gap: 1rem; }
        }

        @media (max-width: 600px) {
            .nav-links { display: none; }
            .profile-container { padding: 0 1rem; margin-top: -2rem; }
            .hero-info h1 { font-size: 1.8rem; }
        }
    </style>
</head>
<body>
    <div class="top-bar">
        <span>‚ö°</span> LIVRAISON GRATUITE √Ä PARTIR DE 500 DH <span>‚ö°</span>
    </div>

    <header class="header">
        <nav class="nav-container">
            <a href="index.html" class="logo-text">SPORT<span>WEAR</span></a>
            <div class="nav-links">
                <a href="index.html">Accueil</a>
                <a href="produits.html">Produits</a>
                <a href="contact.html">Contact</a>
            </div>
            <div class="header-actions">
                <a href="wishlist.html" class="icon-btn" title="Favoris">
                    <svg viewBox="0 0 24 24"><path d="M20.84 4.61a5.5 5.5 0 00-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 00-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 000-7.78z"/></svg>
                </a>
                <a href="produits.html" class="icon-btn" title="Panier">
                    <svg viewBox="0 0 24 24"><circle cx="9" cy="21" r="1"/><circle cx="20" cy="21" r="1"/><path d="M1 1h4l2.68 13.39a2 2 0 002 1.61h9.72a2 2 0 002-1.61L23 6H6"/></svg>
                </a>
            </div>
        </nav>
    </header>

    <section class="profile-hero">
        <div class="hero-content">
            <div class="hero-avatar" id="userAvatar">?</div>
            <div class="hero-info">
                <h1 id="userName">Chargement...</h1>
                <p id="userEmail">...</p>
                <div class="member-badge">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z"/></svg>
                    Membre SPORTWEAR
                </div>
            </div>
        </div>
    </section>

    <div class="profile-container">
        <aside class="profile-sidebar">
            <nav class="sidebar-nav">
                <button class="sidebar-nav-item active" data-tab="dashboard">
                    <svg viewBox="0 0 24 24"><rect x="3" y="3" width="7" height="7" rx="1"/><rect x="14" y="3" width="7" height="7" rx="1"/><rect x="14" y="14" width="7" height="7" rx="1"/><rect x="3" y="14" width="7" height="7" rx="1"/></svg>
                    Tableau de bord
                </button>
                <button class="sidebar-nav-item" data-tab="profile">
                    <svg viewBox="0 0 24 24"><path d="M20 21v-2a4 4 0 00-4-4H8a4 4 0 00-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
                    Mon profil
                </button>
                <button class="sidebar-nav-item" data-tab="orders">
                    <svg viewBox="0 0 24 24"><path d="M6 2L3 6v14a2 2 0 002 2h14a2 2 0 002-2V6l-3-4z"/><line x1="3" y1="6" x2="21" y2="6"/><path d="M16 10a4 4 0 01-8 0"/></svg>
                    Mes commandes
                </button>
                <button class="sidebar-nav-item" data-tab="wishlist">
                    <svg viewBox="0 0 24 24"><path d="M20.84 4.61a5.5 5.5 0 00-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 00-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 000-7.78z"/></svg>
                    Ma wishlist
                </button>
                <button class="sidebar-nav-item" data-tab="security">
                    <svg viewBox="0 0 24 24"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0110 0v4"/></svg>
                    S√©curit√©
                </button>
            </nav>

            <div class="sidebar-divider"></div>

            <button class="logout-btn" onclick="logout()">
                <svg viewBox="0 0 24 24"><path d="M9 21H5a2 2 0 01-2-2V5a2 2 0 012-2h4M16 17l5-5-5-5M21 12H9"/></svg>
                D√©connexion
            </button>
        </aside>

        <main class="profile-main">
            <div class="tab-content active" id="dashboard">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Vue d'ensemble</h3>
                    </div>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon orders">
                                <svg viewBox="0 0 24 24"><path d="M6 2L3 6v14a2 2 0 002 2h14a2 2 0 002-2V6l-3-4z"/><line x1="3" y1="6" x2="21" y2="6"/><path d="M16 10a4 4 0 01-8 0"/></svg>
                            </div>
                            <div class="stat-value" id="ordersCount">0</div>
                            <p class="stat-label">Commandes</p>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon wishlist">
                                <svg viewBox="0 0 24 24"><path d="M20.84 4.61a5.5 5.5 0 00-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 00-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 000-7.78z"/></svg>
                            </div>
                            <div class="stat-value" id="wishlistCount">0</div>
                            <p class="stat-label">Favoris</p>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon reviews">
                                <svg viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>
                            </div>
                            <div class="stat-value" id="reviewsCount">0</div>
                            <p class="stat-label">Avis</p>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Commandes r√©centes</h3>
                        <a href="#" class="card-action" onclick="switchTab('orders'); return false;">Voir tout ‚Üí</a>
                    </div>
                    <div id="recentOrders"></div>
                </div>
            </div>

            <div class="tab-content" id="profile">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Informations personnelles</h3>
                    </div>
                    <form id="profileForm">
                        <div class="form-grid">
                            <div class="form-group">
                                <label>Pr√©nom</label>
                                <input type="text" id="inputFirstName" placeholder="Votre pr√©nom">
                            </div>
                            <div class="form-group">
                                <label>Nom</label>
                                <input type="text" id="inputLastName" placeholder="Votre nom">
                            </div>
                            <div class="form-group full">
                                <label>Email</label>
                                <input type="email" id="inputEmail" placeholder="Votre email" readonly>
                            </div>
                            <div class="form-group">
                                <label>T√©l√©phone</label>
                                <input type="tel" id="inputPhone" placeholder="06 XX XX XX XX">
                            </div>
                            <div class="form-group">
                                <label>Ville</label>
                                <select id="inputCity">
                                    <option value="">S√©lectionnez...</option>
                                    <option value="Casablanca">Casablanca</option>
                                    <option value="Rabat">Rabat</option>
                                    <option value="Marrakech">Marrakech</option>
                                    <option value="Fes">F√®s</option>
                                    <option value="Tanger">Tanger</option>
                                    <option value="Agadir">Agadir</option>
                                    <option value="Meknes">Mekn√®s</option>
                                    <option value="Oujda">Oujda</option>
                                </select>
                            </div>
                            <div class="form-group full">
                                <label>Adresse</label>
                                <input type="text" id="inputAddress" placeholder="Votre adresse compl√®te">
                            </div>
                        </div>
                        <button type="submit" class="save-btn">Enregistrer</button>
                    </form>
                </div>
            </div>

            <div class="tab-content" id="orders">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Mes commandes</h3>
                    </div>
                    <div id="ordersList"></div>
                </div>
            </div>

            <div class="tab-content" id="wishlist">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Ma wishlist</h3>
                    </div>
                    <div id="wishlistItems" class="wishlist-grid"></div>
                </div>
            </div>

            <div class="tab-content" id="security">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Changer le mot de passe</h3>
                    </div>
                    <form id="passwordForm">
                        <div class="form-group">
                            <label>Mot de passe actuel</label>
                            <input type="password" id="currentPassword" placeholder="Votre mot de passe actuel">
                        </div>
                        <div class="form-grid">
                            <div class="form-group">
                                <label>Nouveau mot de passe</label>
                                <input type="password" id="newPassword" placeholder="Nouveau mot de passe">
                            </div>
                            <div class="form-group">
                                <label>Confirmer</label>
                                <input type="password" id="confirmPassword" placeholder="Confirmer">
                            </div>
                        </div>
                        <button type="submit" class="save-btn">Mettre √† jour</button>
                    </form>
                </div>
            </div>
        </main>
    </div>

    <div class="notification" id="notification"></div>

    <script>
        let currentUser = null;

        async function checkAuth() {
            try {
                console.log('üîç Checking auth...');
                const res = await fetch('/api/users/check', { credentials: 'include' });
                const data = await res.json();
                
                console.log('üì• Auth response:', data);
                
                if (!data.loggedIn) {
                    console.log('‚ùå Not logged in');
                    window.location.href = 'user-login.html';
                    return;
                }
                
                await loadProfile();
            } catch (e) {
                console.error('Auth error:', e);
                window.location.href = 'user-login.html';
            }
        }

        async function loadProfile() {
            try {
                const res = await fetch('/api/users/profile', { credentials: 'include' });
                if (!res.ok) throw new Error('Profile error');
                
                const user = await res.json();
                currentUser = user;
                console.log('‚úÖ Profile:', user);
                
                const fullName = `${user.firstName || ''} ${user.lastName || ''}`.trim() || 'Utilisateur';
                
                document.getElementById('userName').textContent = fullName;
                document.getElementById('userEmail').textContent = user.email;
                document.getElementById('userAvatar').textContent = fullName.charAt(0).toUpperCase();
                
                document.getElementById('inputFirstName').value = user.firstName || '';
                document.getElementById('inputLastName').value = user.lastName || '';
                document.getElementById('inputEmail').value = user.email || '';
                document.getElementById('inputPhone').value = user.phone || '';
                document.getElementById('inputCity').value = user.address?.city || '';
                document.getElementById('inputAddress').value = user.address?.street || '';
                
                loadStats();
                loadOrders();
                loadWishlist();
            } catch (e) {
                console.error('Profile error:', e);
                showNotification('Erreur de chargement', 'error');
            }
        }

        async function loadStats() {
            try {
                const res = await fetch('/api/users/orders', { credentials: 'include' });
                const orders = await res.json();
                document.getElementById('ordersCount').textContent = Array.isArray(orders) ? orders.length : 0;
            } catch (e) {
                document.getElementById('ordersCount').textContent = '0';
            }
            
            const wishlist = JSON.parse(localStorage.getItem('wishlist') || '[]');
            document.getElementById('wishlistCount').textContent = wishlist.length;
            document.getElementById('reviewsCount').textContent = '0';
        }

        async function loadOrders() {
            try {
                const res = await fetch('/api/users/orders', { credentials: 'include' });
                const orders = await res.json();
                
                const ordersList = document.getElementById('ordersList');
                const recentOrders = document.getElementById('recentOrders');
                
                if (!Array.isArray(orders) || orders.length === 0) {
                    const emptyHTML = `
                        <div class="empty-state">
                            <svg viewBox="0 0 24 24"><path d="M6 2L3 6v14a2 2 0 002 2h14a2 2 0 002-2V6l-3-4z"/><line x1="3" y1="6" x2="21" y2="6"/><path d="M16 10a4 4 0 01-8 0"/></svg>
                            <h3>Aucune commande</h3>
                            <p>Vous n'avez pas encore pass√© de commande</p>
                            <a href="produits.html">D√©couvrir nos produits</a>
                        </div>
                    `;
                    ordersList.innerHTML = emptyHTML;
                    recentOrders.innerHTML = emptyHTML;
                    return;
                }
                
                const renderOrder = (order) => `
                    <div class="order-card">
                        <div class="order-info">
                            <h4>Commande #${order.trackingNumber || order._id.slice(-8).toUpperCase()}</h4>
                            <p>${new Date(order.createdAt).toLocaleDateString('fr-FR')} ‚Ä¢ ${order.items?.length || 0} article(s)</p>
                        </div>
                        <span class="order-status ${order.status}">${getStatusLabel(order.status)}</span>
                        <span class="order-amount">${order.totalAmount?.toFixed(2) || '0.00'} DH</span>
                    </div>
                `;
                
                ordersList.innerHTML = orders.map(renderOrder).join('');
                recentOrders.innerHTML = orders.slice(0, 3).map(renderOrder).join('');
            } catch (e) {
                console.error('Orders error:', e);
            }
        }
        
        function getStatusLabel(status) {
            const labels = {
                'pending': 'En attente',
                'confirmed': 'Confirm√©e',
                'processing': 'En cours',
                'shipped': 'Exp√©di√©e',
                'delivered': 'Livr√©e',
                'cancelled': 'Annul√©e'
            };
            return labels[status] || status;
        }

        function loadWishlist() {
            const wishlist = JSON.parse(localStorage.getItem('wishlist') || '[]');
            const container = document.getElementById('wishlistItems');
            
            document.getElementById('wishlistCount').textContent = wishlist.length;
            
            if (wishlist.length === 0) {
                container.innerHTML = `
                    <div class="empty-state" style="grid-column: 1/-1;">
                        <svg viewBox="0 0 24 24"><path d="M20.84 4.61a5.5 5.5 0 00-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 00-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 000-7.78z"/></svg>
                        <h3>Votre wishlist est vide</h3>
                        <p>Ajoutez des produits √† vos favoris</p>
                        <a href="produits.html">Parcourir les produits</a>
                    </div>
                `;
                return;
            }

            container.innerHTML = wishlist.map(item => `
                <div class="wishlist-item">
                    <img src="/${item.img || item.image}" alt="${item.name}" onerror="this.src='https://via.placeholder.com/200x180?text=Image'">
                    <div class="wishlist-item-info">
                        <h4>${item.name}</h4>
                        <p class="price">${item.price} DH</p>
                        <div class="wishlist-actions">
                            <button class="wishlist-btn add-cart" onclick="addToCart('${item.id}')">Ajouter</button>
                            <button class="wishlist-btn remove" onclick="removeFromWishlist('${item.id}')">‚úï</button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function removeFromWishlist(id) {
            let wishlist = JSON.parse(localStorage.getItem('wishlist') || '[]');
            wishlist = wishlist.filter(item => item.id !== id);
            localStorage.setItem('wishlist', JSON.stringify(wishlist));
            loadWishlist();
            showNotification('Produit retir√© des favoris', 'success');
        }
        
        function addToCart(id) {
            const wishlist = JSON.parse(localStorage.getItem('wishlist') || '[]');
            const item = wishlist.find(i => i.id === id);
            
            if (item) {
                let cart = JSON.parse(localStorage.getItem('shopCart') || '[]');
                const existing = cart.find(c => c.id === id);
                
                if (existing) {
                    existing.qty++;
                } else {
                    cart.push({ ...item, qty: 1 });
                }
                
                localStorage.setItem('shopCart', JSON.stringify(cart));
                showNotification('Produit ajout√© au panier!', 'success');
            }
        }

        async function logout() {
            try {
                await fetch('/api/users/logout', { method: 'POST', credentials: 'include' });
                localStorage.removeItem('user');
                window.location.href = 'index.html';
            } catch (e) {
                window.location.href = 'index.html';
            }
        }

        document.querySelectorAll('.sidebar-nav-item').forEach(item => {
            item.addEventListener('click', () => switchTab(item.dataset.tab));
        });

        function switchTab(tabId) {
            document.querySelectorAll('.sidebar-nav-item').forEach(i => i.classList.remove('active'));
            document.querySelector(`[data-tab="${tabId}"]`).classList.add('active');
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
            document.getElementById(tabId).classList.add('active');
        }

        document.getElementById('profileForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const data = {
                firstName: document.getElementById('inputFirstName').value,
                lastName: document.getElementById('inputLastName').value,
                phone: document.getElementById('inputPhone').value,
                address: {
                    street: document.getElementById('inputAddress').value,
                    city: document.getElementById('inputCity').value
                }
            };

            try {
                const res = await fetch('/api/users/profile', {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    credentials: 'include',
                    body: JSON.stringify(data)
                });

                if (res.ok) {
                    showNotification('Profil mis √† jour!', 'success');
                    const fullName = `${data.firstName} ${data.lastName}`.trim();
                    document.getElementById('userName').textContent = fullName;
                    document.getElementById('userAvatar').textContent = fullName.charAt(0).toUpperCase();
                } else {
                    showNotification('Erreur lors de la mise √† jour', 'error');
                }
            } catch (error) {
                showNotification('Erreur de connexion', 'error');
            }
        });

        document.getElementById('passwordForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const newPassword = document.getElementById('newPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;

            if (newPassword !== confirmPassword) {
                showNotification('Les mots de passe ne correspondent pas', 'error');
                return;
            }
            
            showNotification('Fonction bient√¥t disponible', 'success');
            document.getElementById('passwordForm').reset();
        });

        function showNotification(message, type = 'success') {
            const notif = document.getElementById('notification');
            notif.textContent = message;
            notif.className = 'notification show ' + type;
            setTimeout(() => notif.classList.remove('show'), 3500);
        }

        checkAuth();
    </script>
</body>
</html>
